# 📊 Windows 95 计算器增强功能文档

## 🎯 新增功能概览

本次更新为Windows 95桌面模拟器添加了完整的Win95风格计算器应用，包含以下主要功能：

### ✨ 核心功能

#### 1. 🖥️ 经典Windows 95界面
- **像素级精确的UI布局** - 完全还原Windows 95计算器的视觉效果
- **3D按钮效果** - 正确的凸起/凹陷效果和颜色方案
- **菜单栏** - 包含"查看"、"编辑"、"帮助"选项
- **内存指示器** - 显示"M"标识当内存中有数值时
- **模式切换标签** - 标准型/科学型模式切换

#### 2. 🧮 基础四则运算
- **数字输入** - 支持0-9数字输入，自动处理前导零
- **基本运算** - 加法(+)、减法(-)、乘法(×)、除法(÷)
- **连续运算** - 支持链式计算，如：2+3×4=
- **等号重复** - 按等号重复上一次运算
- **小数点处理** - 智能小数点输入和显示

#### 3. 💾 完整内存功能
- **MC (Memory Clear)** - 清除内存中存储的数值
- **MR (Memory Recall)** - 调用内存中存储的数值
- **MS (Memory Store)** - 将当前显示值存储到内存
- **M+ (Memory Plus)** - 将当前值加到内存中
- **M- (Memory Minus)** - 从内存中减去当前值
- **内存指示器** - 内存非零时显示"M"标识

#### 4. ⌨️ 完整键盘输入支持
- **数字键** - 数字0-9直接输入
- **运算符** - +、-、*、/ 对应四则运算
- **功能键**：
  - `Enter` 或 `=` - 计算结果
  - `Backspace` - 删除最后一位
  - `Delete` 或 `Escape` - 清除所有
  - `.` - 小数点
  - `%` - 百分比运算

#### 5. 🔬 科学计算器模式
- **三角函数** - sin、cos、tan（角度制）
- **对数函数** - log（常用对数）、ln（自然对数）
- **幂运算** - x²（平方）、x³（立方）、xʸ（任意幂）
- **根号运算** - √x（平方根）
- **倒数** - 1/x
- **常数** - π（圆周率）、e（自然常数）
- **符号变换** - ±（正负号切换）

#### 6. 🎛️ 高级功能
- **百分比计算** - 支持百分比运算
- **错误处理** - 除零错误、负数开方等异常处理
- **显示格式化** - 超长数字自动科学计数法显示
- **音效反馈** - 按键点击音效和错误提示音
- **帮助系统** - 详细的使用说明和快捷键指南

## 🎨 界面设计特色

### 颜色方案
- **按钮背景** - 经典Win95灰色(#c0c0c0)
- **数字按钮** - 白色背景突出显示
- **运算符按钮** - 标准灰色背景
- **内存按钮** - 深蓝色文字(#000080)
- **等号按钮** - 蓝色背景(#316ac5)，白色文字
- **科学函数** - 深蓝色文字，区别于普通按钮

### 布局特点
- **标准模式** - 5列布局，内存功能位于顶部
- **科学模式** - 6列布局，增加科学函数
- **按钮分组** - 内存、运算符、数字、功能按钮分类设计
- **响应式** - 等号按钮在标准模式下跨两行显示

## 🔧 技术实现亮点

### 计算引擎
```javascript
// 高精度计算处理
const calculate = () => {
    const prev = previousValue;
    const current = parseFloat(currentValue);
    
    switch (operation) {
        case 'add': return prev + current;
        case 'subtract': return prev - current;
        case 'multiply': return prev * current;
        case 'divide': 
            if (current === 0) {
                this.playErrorSound();
                return 0;
            }
            return prev / current;
        default: return current;
    }
};
```

### 键盘事件处理
```javascript
// 全面的键盘输入支持
const handleKeyPress = (event) => {
    event.preventDefault();
    const key = event.key;
    
    if (/[0-9]/.test(key)) {
        inputNumber(key);
    } else {
        // 处理运算符和功能键...
    }
};
```

### 内存管理
```javascript
// 完整的内存功能
const handleMemoryOperation = (action) => {
    const value = parseFloat(currentValue);
    
    switch (action) {
        case 'memory-clear': memory = 0; break;
        case 'memory-recall': /* ... */ break;
        case 'memory-store': memory = value; break;
        case 'memory-add': memory += value; break;
        case 'memory-subtract': memory -= value; break;
    }
    
    updateMemoryIndicator();
};
```

## 📋 使用说明

### 基本操作
1. **数字输入** - 点击数字按钮或键盘输入
2. **运算** - 输入数字 → 选择运算符 → 输入第二个数字 → 按等号
3. **连续运算** - 可以连续进行多次运算
4. **清除** - C键清除所有，CE键清除当前输入

### 内存操作
1. **存储** - 输入数字 → 按MS存储到内存
2. **调用** - 按MR调用内存中的数值
3. **累加** - M+将当前值加到内存，M-将当前值从内存减去
4. **清除** - MC清除内存

### 科学模式
1. **切换模式** - 点击"科学型"标签或查看菜单
2. **三角函数** - 输入角度（度数制）→ 选择sin/cos/tan
3. **对数** - 输入正数 → 选择log或ln
4. **幂运算** - 输入底数 → 选择x²、x³或xʸ

### 快捷键
- `0-9` - 数字输入
- `+` `-` `*` `/` - 四则运算
- `Enter` `=` - 计算
- `Backspace` - 退格
- `Delete` `Escape` - 清除
- `.` - 小数点
- `%` - 百分比

## 🐛 错误处理

### 数学错误
- **除零错误** - 显示0并播放错误音效
- **负数开方** - 阻止操作并播放错误音效
- **对数错误** - 负数或零的对数操作被阻止

### 显示限制
- **长数字** - 超过12位自动转为科学计数法
- **小数精度** - 自动处理浮点数精度问题
- **溢出处理** - 极大或极小数字的合理显示

## 🎵 音效系统

- **按键音效** - 每次按钮点击播放点击音
- **错误音效** - 数学错误时播放错误提示音
- **音效控制** - 可通过全局音效开关控制

## 🔄 兼容性

### 浏览器支持
- ✅ Chrome 80+
- ✅ Firefox 75+ 
- ✅ Safari 13+
- ✅ Edge 80+

### 设备支持
- ✅ 桌面设备（完整功能）
- ✅ 平板设备（触摸支持）
- ✅ 手机设备（响应式布局）

## 📈 性能优化

- **事件委托** - 使用事件委托减少内存占用
- **按需渲染** - 模式切换时动态生成按钮
- **内存管理** - 窗口关闭时清理事件监听器
- **计算优化** - 高效的数学运算算法

---

这个增强版计算器完全符合Windows 95的设计规范，提供了完整的功能和出色的用户体验！🎉